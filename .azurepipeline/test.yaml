pool:
  vmImage: 'ubuntu-latest'

variables:
  TEST_ASSET_KUBE_APISERVER: '/tmp/kubebuilder_2.2.0_linux_amd64/bin/kube-apiserver'
  TEST_ASSET_ETCD: '/tmp/kubebuilder_2.2.0_linux_amd64/bin/etcd'
  TEST_ASSET_KUBECTL: '/tmp/kubebuilder_2.2.0_linux_amd64/bin/kubectl'

steps:
  - task: GoTool@0
    inputs:
      version: '1.13.5'
  - task: Cache@2
    inputs:
      key: 'go | "$(Agent.OS)" | go.*'
      restoreKeys: |
        go | "$(Agent.OS)"
        go
      path: vendor
    displayName: Go_Vendor_Cache
  - script: make setup-ci
    displayName: Setup_CI
  - script: make test-ci
    displayName: Run_Test
